@model IEnumerable<dubbingModel.orderTrnHdr>
@{
    string panelHeaderClass;
    string episode;
}

<div class="container-fluid">
    @foreach (dubbingModel.orderTrnHdr item in Model)
    {
        if (item.status == "03") { panelHeaderClass = "panel-danger"; }
        else if (item.priority == "03") { panelHeaderClass = "panel-warning"; }
        else { panelHeaderClass = "panel-default"; }

        episode = item.agreementWork.workName + " / Ep " + item.episodeNo;

        <div class="panel @panelHeaderClass">
            <div class="panel-heading">
                <div class="row">
                    <div class="col-sm-1">
                        <button class="btn btn-default btn-sm" onclick="onOrderItemSelectClick(@item.orderTrnHdrIntno, '@episode', '@item.status')" title="Select">
                            <span class="glyphicon glyphicon-triangle-right" aria-hidden="true"></span>
                        </button>
                    </div>
                    <div class="col-sm-3">
                        <label class="alert-info" style="height:30px; font-size:30px; font-weight:bolder;">@item.episodeNo</label>
                        <small>&nbsp;/@item.orderIntno</small>
                    </div>
                    <div class="col-sm-5">
                        <label><small>@item.agreementWork.workName</small></label>
                    </div>
                    <div class="col-sm-3">
                        <button class="btn btn-default btn-xs pull-right" onclick="onOrderItemComplainsClick(@item.orderTrnHdrIntno)" title="Client Feedback">
                            <span class="glyphicon glyphicon-wrench" aria-hidden="true"></span>
                        </button>
                        <button class="btn btn-default btn-xs pull-right" onclick="onOrderItemIssueClick(@item.orderTrnHdrIntno)" title="Issues">
                            <span class="glyphicon glyphicon-bell" aria-hidden="true"></span>
                        </button>
                        <button class="btn btn-default btn-xs pull-right" onclick="onOrderItemDetailsClick(@item.orderTrnHdrIntno)" title="Details">
                            <span class="glyphicon glyphicon-bookmark" aria-hidden="true"></span>
                        </button>
                    </div>
                </div>
            </div>
            <div class="panel-body">
                <div class="row">
                    <div class="col-sm-2" style="text-align:center"><label><small>Received</small></label></div>
                    <div class="col-sm-2" style="text-align:center"><label><small>On Air</small></label></div>
                    <div class="col-sm-2" style="text-align:center"><label><small>Adaptation</small></label></div>
                    <div class="col-sm-2" style="text-align:center"><label><small>Dubbing</small></label></div>
                    <div class="col-sm-2" style="text-align:center"><label><small>Upload</small></label></div>
                    <div class="col-sm-2" style="text-align:center"><label><small>Shipment</small></label></div>
                </div>

                <div class="row">
                    <div class="col-sm-2" style="text-align:center">
                        <small>
                            @{
                                if (item.orderReceivedDate.HasValue)
                                {
                                    if (!item.startAdaptation.HasValue)
                                    {
                                        <label class="badge alert-success">@item.orderReceivedDate.Value.ToShortDateString()</label>
                                    }
                                    else
                                    {
                                        @item.orderReceivedDate.Value.ToShortDateString()
                                    }
                                }
                            }
                        </small>
                    </div>
                    <div class="col-sm-2" style="text-align:center">
                        <small>
                            @{
                                if (item.expectedDeliveryDate.HasValue)
                                {
                                    @item.expectedDeliveryDate.Value.ToShortDateString()
                                }
                            }
                        </small>
                    </div>
                    <div class="col-sm-2">
                        <small>
                            @{
                                if (item.startAdaptation.HasValue)
                                {
                                    if (!item.startDubbing.HasValue)
                                    {
                                        <label class="badge alert-success">@item.startAdaptation.Value.ToShortDateString()</label>
                                    }
                                    else
                                    {
                                        @item.startAdaptation.Value.ToShortDateString()
                                    }
                                }
                            }
                        </small>
                    </div>
                    <div class="col-sm-2">
                        <small>
                            @{
                                if (item.startDubbing.HasValue && !item.shipmentLowRes.HasValue)
                                {
                                    <label class="badge alert-success">@item.startDubbing.Value.ToShortDateString()</label>
                                }
                                else if (!item.startDubbing.HasValue && item.plannedDubbing.HasValue)
                                {
                                    @item.plannedDubbing.Value.ToShortDateString()
                                }
                            }
                        </small>
                    </div>
                    <div class="col-sm-2">
                        <small>
                            @{
                                if (item.endDubbing.HasValue && !item.shipmentLowRes.HasValue && item.plannedUpload.HasValue)
                                {
                                    <label class="badge alert-success">@item.plannedUpload.Value.ToShortDateString()</label>
                                }
                                else if (item.shipmentLowRes.HasValue)
                                {
                                    @item.shipmentLowRes.Value.ToShortDateString()
                                }
                                else if (!item.endDubbing.HasValue && item.plannedUpload.HasValue)
                                {
                                    @item.plannedUpload.Value.ToShortDateString()
                                }
                            }
                        </small>
                    </div>
                    <div class="col-sm-2">
                        <small>
                            @{
                                if (item.shipmentLowRes.HasValue && !item.shipmentFinal.HasValue && item.plannedShipment.HasValue)
                                {
                                    <label class="badge alert-success">@item.plannedShipment.Value.ToShortDateString()</label>
                                }
                                else if (item.shipmentFinal.HasValue)
                                {
                                    @item.shipmentFinal.Value.ToShortDateString()
                                }
                                else if (!item.shipmentFinal.HasValue && item.plannedShipment.HasValue)
                                {
                                    @item.plannedShipment.Value.ToShortDateString()
                                }
                            }
                        </small>
                    </div>
                </div>
            </div>
        </div>
    }
</div>
