@using dubbingModel
@model IEnumerable<tagTemplateHdr>

@{
    ViewBag.Title = "Index";
}
<link href="~/Content/themes/base/jquery-ui.css" rel="stylesheet" />
<h2>Voice Templates</h2>
<hr />

<div class="row">
    <a class="btn btn-primary" data-toggle="modal" data-target="#newTemplate">New Template</a>
</div>
<br />
<br />

<div class="row">
    <div id="tempContainer">
        @Html.Partial("_templates", Model)
    </div>
</div>
<div class="modal fade" id="newTemplate" tabindex="-1" role="dialog" aria-labelledby="newTemplate-label">
    <div class="modal-dialog" role="document">
        <div class="modal-content">
            <div class="modal-header">
                <button type="button" class="close" data-dismiss="modal" aria-label="Close"><span aria-hidden="true">&times;</span></button>
                <h4 class="modal-title" id="newTemplate-label">New Template</h4>
            </div>
            <div class="modal-body">
                <form>
                    <div class="form-group">
                        <label for="tempTitle">Title</label>
                        <input id="tempTitle" name="tempTitle" placeholder="Enter title" class="form-control" value=""/>
                    </div>
                    <div class="form-group">
                        <label for="tempText">Text</label>
                        <input id="tempText" name="tempText" placeholder="Enter text scentence to be recorded" class="form-control" value="" />
                    </div>
                    <div class="form-group">
                        <label for="tempDesc">Description</label>
                        <textarea id="tempDesc" name="tempDesc" rows="2" class="form-control"></textarea>
                    </div>

                </form>
            </div>
            <div class="modal-footer">
                <button type="button" class="btn btn-default" data-dismiss="modal">Close</button>
                <button type="button" class="btn btn-primary" data-dismiss="modal" onclick="saveTemplate();">Save</button>
                
            </div>
        </div>
    </div>
</div>

@section Scripts
{
    <script src="~/Scripts/jquery-ui-1.12.1.js"></script>
    <script>
        function saveTemplate() {
            var title = $("#tempTitle").val();
            var text = $("#tempText").val();
            var desc = $("#tempDesc").val();
            var url = '/Templates/SaveTemplate';

            $.ajax({
                contentType: 'application/json',
                method: 'GET',
                url: url,
                data: { title: title, text: text, description: desc },
                success: function (result) {
                    $("#tempContainer").empty();
                    $("#tempContainer").html(result);
                }
            });
        }
        function saveTempDtl(tempId) {
            var tagName = $("#newTagName_" + tempId).val();
            var minScore = $("#newMinScore_" + tempId).val();
            var weight = $("#newWeight_" + tempId).val();
            var url = '/Templates/SaveTemplateTag';

            $.ajax({
                contentType: 'application/json',
                method: 'GET',
                url: url,
                data: { tagTemplateHdrIntno: tempId, tagName: tagName, minScore: minScore, weight: weight },
                success: function (result) {
                    $("#tempContainer").empty();
                    $("#tempContainer").html(result);
                }
            });
        }
        function deleteTempDtl(id) {
            var url = '/Templates/DeleteTemplateTag';

            $.ajax({
                contentType: 'application/json',
                method: 'GET',
                url: url,
                data: { tagTemplateDtlIntno: id },
                success: function (result) {
                    $("#tempContainer").empty();
                    $("#tempContainer").html(result);
                }
            });
        }
        $(function () {
            var availableTags = [];
            @foreach (var d in ViewBag.Tags)
            {
                @:availableTags.push("@d");
            }
            $(".tag").autocomplete({
                source: availableTags
            });
        });
    </script>
}



